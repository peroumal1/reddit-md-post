Metadata-Version: 2.4
Name: rss_summary
Version: 0.1.0
Summary: Default template for PDM package
Author-email: prmlnk <peroumal@hey.com>
License: MIT
Requires-Python: ==3.14.*
Description-Content-Type: text/markdown
Requires-Dist: feedparser>=6.0.12
Requires-Dist: datetime>=6.0
Requires-Dist: sentence-transformers>=5.2.2
Requires-Dist: py-markdown-table>=1.3.0
Requires-Dist: bs4>=0.0.2
Requires-Dist: click>=8.3.1
Requires-Dist: praw>=7.8.1
Requires-Dist: playwright>=1.58.0
Requires-Dist: dotenv>=0.9.9
Requires-Dist: pyotp>=2.9.0
Requires-Dist: requests>=2.32.5
Requires-Dist: pathlib>=1.0.1

# Running the scripts

## Python and dependencies

mise is used for the Python setup in the folder (python and pdm)
- install mise: https://mise.jdx.dev/installing-mise.html
- in the folder run `mise install` to install the requirements
- run `mise use` to activate the requirements

Once mise is installed run `pdm add` to add all the python dependencies

## Project structure

```
src/
  rss_summary/          # Main package
    aggregate.py        # CLI entry point (click)
    similarity.py       # Duplicate detection via sentence transformers
    parsing.py          # HTML parsing and image extraction
    formatting.py       # Markdown table formatting
    last_run.py         # Last run date persistence
  post_to_reddit.py     # Reddit posting script
tests/
  test_similarity.py
  test_parsing.py
  test_formatting.py
  test_last_run.py
  test_markdown_generation.py
data/
  rss_list.txt          # RSS feed URLs (one per line)
  feed-*.md             # Generated feed outputs
```

## Running the aggregation script

`pdm run aggregate-rss [rss_file] [output_md_file] --with-images`

The aggregation script reads RSS feeds from the links provided in `rss_file`
and aggregates them into a Markdown table written to `output_md_file`.
Both parameters are optional, defaulting to `data/rss_list.txt` and
`data/feed.md` respectively.

### Duplicate detection

The script uses a sentence transformer model
(`paraphrase-multilingual-mpnet-base-v2`) to detect semantically similar
summaries and exclude duplicates. The model is downloaded locally on first run.
The similarity threshold is configurable via the `SIMILARITY_THRESHOLD` constant
in `src/rss_summary/similarity.py` (default: `0.6`).

### Images

The `--with-images` flag adds a preview column to the output table. It uses the
`media_content` from the RSS feed when available, or falls back to the first
`<img>` found on the article page.

### Last run tracking

The date of last execution is stored in `.last-run` so that only entries
published since the previous run are fetched. If the file is missing or
corrupted, the script defaults to midnight of the current day.

## Running the tests

`pdm run pytest`

## Running the post_to_reddit script

XXX TODO
